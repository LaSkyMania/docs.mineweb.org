<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>MineWeb docs</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://mineweb.org'>Retour sur mineweb.org</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<h2 id="c-39-est-quoi-mineweb">C&#39;est quoi MineWeb ?</h2>

<p>MineWeb est un <strong>CMS</strong>. Un CMS est un système de gestion de contenu. Plus précisément il vous permet de vous créer rapidement et facilement un site complètement personnalisable. MineWeb est la version 2 de l&#39;ancien CMS <strong>LapisCraft</strong> de Eywek. Celui-ci n&#39;étant plus stable et mal développé (cf. raisons <a href="http://eywek.fr/lc-explications.pdf">ici</a>).</p>

<p>MineWeb est développé sous un framework PHP nommé <strong>CakePHP</strong> permettant un développement plus <strong>rapide</strong>, <strong>sécurisé</strong> et <strong>optimisé</strong>. Le projet a été lancé il y a maintenant plus d&rsquo;<strong>1 an</strong> en compagnie de <strong>Mac&rsquo;</strong> permettant de convenir entièrement à <strong>vos besoins</strong>.</p>

<h2 id="pr-requis">Pré-requis</h2>

<aside class="alert alert-info"><strong>Hébergeur compatible :</strong> L'hébergeur <a href= "http://revolta-hosting.fr">Revolta-Hosting</a> est 100% <strong>compatible</strong> avec notre CMS !</aside>

<p>Pour installer le CMS MineWeb votre hébergeur <strong>doit</strong> avoir :</p>

<ul>
<li>  Version PHP supérieure ou égale à 5.4 (&lt; 7.0.0)</li>
<li>  PDO activé</li>
<li>  cURL activé</li>
<li>  Réécriture d&#39;URL</li>
<li>  .htaccess activés</li>
<li>  La librairie GD2</li>
<li>  La possibilité d&#39;ouvrir un zip</li>
<li>  La possibilité d&#39;ouvrir un site à distance</li>
<li>  ionCube Loader version 5.4</li>
<li>  OpenSSL</li>
</ul>

<p>Pour plus de simplicité vous pouvez télécharger le <strong>fichier de compatibilité</strong> <a href="http://mineweb.org/files/compatibilite.zip">ici</a>. Vous avez juste à extraire cette archive sur votre FTP pour voir si votre hébergeur est compatible.</p>

<h2 id="licence-h-berg-e-mineweb">Licence hébergée MineWeb</h2>

<p>Vous ne souhaitez pas vous embêter à chercher un <strong>hébergeur compatible</strong> ? Alors n&#39;attendez plus et utilisez <strong>nos licences hébergées</strong>, votre licence sera installée <strong>automatiquement</strong> et <strong>sans aucun effort</strong>. Tous les prix et informations sont disponibles <a href="http://mineweb.org/download">ici</a>.</p>

          <h1 id="installation">Installation</h1>

<aside class="alert alert-info">
<h3>Informations</h3>
<p>Vous devez placer tout le contenu de l'archive téléchargée sur votre espace membre, sur votre hébergeur (les fichiers .DS_Store & \__MACOSX sont inutiles). Il faut ensuite appliquer les permissions 755 ou 775 sur tout les fichiers (pour permettre les mises à jour). Puis rendez-vous sur sur http://{votre site}/install</p>
</aside>

<h2 id="tape-1-configuration-de-la-base-de-donn-es">Étape 1 - Configuration de la base de données</h2>

<p><strong>Sautez cette étape si vous utilisez l&#39;hébergeur MineWeb</strong></p>

<p>Vous devez avoir une page demandant vos identifiants de base de données, vous devez entrez ceux-ci et tester la connexion, puis il vous faudra cliquer sur un bouton qui installera la base de données automatiquement.</p>

<h2 id="tape-2-mise-en-place-de-la-licence">Étape 2 - Mise en place de la licence</h2>

<p>Une fois la connexion à la base de données effectuée, le CMS vous demandera alors votre clé d&#39;activation. Celle-ci est disponible sur votre <a href="http://mineweb.org/user/profile">profil</a>.
Si vous obtenez des erreurs, voici leurs explications et résolutions.</p>

<table><thead>
<tr>
<th>Erreur</th>
<th>Explication</th>
<th>Résolution</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">Licence inconnue</code></td>
<td>Votre licence n&#39;est pas trouvée dans notre base de données</td>
<td>Téléchargez à nouveau les fichiers du CMS</td>
</tr>
<tr>
<td><code class="prettyprint">Site d&#39;installation non valide</code></td>
<td>L&#39;URL que vous utilisez pour accèder à votre site ne correspond pas à celle configurée</td>
<td>Rendez-vous sur votre <a href="http://localhost:1337/user/profile">profil</a> et changez l&#39;URL de votre licence</td>
</tr>
<tr>
<td><code class="prettyprint">Licence désactivée</code></td>
<td>La licence n&#39;est pas activée</td>
<td>Rendez-vous sur votre <a href="http://mineweb.org/user/profile">profil</a> et réactivez votre licence. Celle-ci peut être désactivée par l&#39;administration si un problème survient, une explication est alors affichée</td>
</tr>
<tr>
<td><code class="prettyprint">L&#39;API de MineWeb.org est temporairement indisponible</code></td>
<td>Le système de vérification de licence n&#39;est pas disponible</td>
<td>Patientez, si ce problème survient nous travaillons à la résolution du problème</td>
</tr>
</tbody></table>

<h2 id="tape-3-cr-ation-de-l-39-administrateur">Étape 3 - Création de l&#39;administrateur</h2>

<p>Voici la troisième et dernière étape de l&#39;installation du CMS, vous allez créer votre compte administrateur qui permettra d&#39;accéder au panel admin du CMS. Vous avez juste à remplir les champs qui vous sont présentés et à soumettre vos informations en cliquant sur le bouton &ldquo;Suivant&rdquo;.</p>

<h2 id="installation-termin-e">Installation terminée</h2>

<p>Une fois l&#39;installation du CMS complétée vous pouvez passer à l&#39;utilisation du CMS en lui-même. Pour configurer votre CMS il vous faut vous connecter en cliquant sur le bouton en haut à gauche de la barre de navigation. Vous cliquez sur connexion puis entrez vos informations pour vous connecter. Vous cliquez ensuite sur Panel administrateur, vous serez redirigé et vous pourrez ensuite cliquer sur <em>Général</em> puis <em>Préférences générales</em>.</p>

<h2 id="aide-externe-et-probl-mes-fr-quents">Aide externe et problèmes fréquents</h2>

<h3 id="probl-me-avec-ioncube">Problème avec ionCube</h3>

<p>Il est possible que vous obteniez une erreur dans ce style là :</p>

<p><code class="prettyprint">/app/Controller/Component/UpdateComponent.php cannot be decoded by this version of the ionCube Loader. If you are the administrator of this site then please install the latest version of the ionCube Loader.</code></p>

<p>Cela signifie que votre hébergeur n&#39;a pas installé la bonne version du <em>ionCube Loader</em>, il faut alors voir avec leur support. À noter que la version de PHP ne doit pas être supérieur à la version 7.</p>

<h3 id="probl-me-chez-livehost">Problème chez livehost</h3>

<p>Il est possible que vous obteniez une erreur dans ce style là :</p>

<p><code class="prettyprint">Warning: include(Cake/bootstrap.php): failed to open stream: No such file or directory in</code></p>

<p>Pour résoudre ce problème, rendez-vous dans <em>app/webroot</em>, ouvrez le fichier <em>index.php</em> et allez à la ligne 64</p>

<p><code class="prettyprint">//define(&#39;CAKE_CORE_INCLUDE_PATH&#39;, ROOT . DS . &#39;lib&#39;);</code></p>

<p>Retirez les deux slashs</p>

<p><code class="prettyprint">define(&#39;CAKE_CORE_INCLUDE_PATH&#39;, ROOT . DS . &#39;lib&#39;);</code></p>

<p>Sauvegardez et rechargez la page.</p>

<h3 id="autres">Autres</h3>

<ul>
<li>Si vous êtes hébergé chez <strong>Revolta-Hosting</strong>, vous pouvez suivre ce <a href="http://forum.revolta-hosting.fr/threads/installer-mineweb.692/">tutoriel</a>.</li>
<li>Si vous avez besoin d&#39;aide, si vous rencontrez un problème non répertorié ici, vous pouvez nous contacter sur le <a href="http://mineweb.org/support">support</a>.</li>
</ul>

          <h1 id="lier-serveur-site">Lier serveur-site</h1>

<aside class="alert alert-warning">
  <h3>Compatibilité</h3>
  <p>Les plugins sont compatibles à partir de la version 1.7.10</p>
  <p><small><em>Des problèmes de compatibilités peuvent survenir avec Cauldron.</em></small></p>
</aside>

<aside class="alert alert-info">
  <p><strong>Type de connexion</strong>:  <br>
  - Par défaut : <em>Connexion à un serveur lié avec le <a href="http://mineweb.org/dl/plugin/bukkit/last">plugin Bukkit/Spigot</a>, permet l’utilisation de toutes les fonctionnalités du CMS (Boutique, Classement factions, Vote…)</em> <br>
  - BungeeCord : <em>Connexion à un serveur lié avec le <a href="http://mineweb.org/plugin_bungee/1.0.3-mineweb_bungee.jar">plugin BungeeCord</a>, permet l’utilisation de <strong>certaines fonctionnalités</strong> (affichage des joueurs, commandes, mais la <strong>boutique</strong> et le <strong>classement</strong> factions <strong>ne pourront pas être utilisés</strong> avec ce type de connexion)</em> <br>
  - Ping : <em>Connexion à un serveur sans plugin, permet uniquement d’avoir le nombre de joueurs en ligne et le nombre de joueurs maximums (La <strong>boutique</strong> et le <strong>classement</strong> factions <strong>ne pourront pas être utilisés</strong> avec ce type de connexion) </em></p>
</aside>

<h2 id="configuration-pr-alable">Configuration préalable</h2>

<p>Rendez-vous sur la page de liaison site-serveur sur le panel admin de votre CMS.
Vous devez dans un premier temps configurer le temps d’exécution maximum (appelé aussi timeout), il est conseillé de mettre 1 (secondes).</p>

<p><img src="http://pic.eywek.fr/491537.png" /></p>

<aside class="alert alert-info">
Vous avez a côté 2 boutons pour désactiver la fonctionnalité (mettra automatiquement le statut du serveur à éteint) si vous ne souhaiter pas utiliser la liaison site-serveur. Et un autre bouton pour activer/désactiver le cache sur la “bannière” (Permet que le message affiché sur le site (joueurs connectés, MOTD…) soit stocké pendant quelques minutes permettant d’éviter la surcharge de commande au serveur)
</aside>

<h2 id="liaison-un-serveur-bukkit-spigot">Liaison à un serveur Bukkit/Spigot</h2>

<p>Maintenant nous allons lier votre <strong>serveur Minecraft</strong> au <strong>CMS</strong>. Pour cela vous devez avoir installé sur votre serveur le plugin MineWeb disponible à <a href="http://mineweb.org/dl/plugin/bukkit/last">cette adresse</a>.
Une fois le plugin téléchargé, placez-le dans votre dossier plugins de votre serveur et <strong>redémarrez celui-ci</strong>.
Vous n’avez <strong>pas à toucher à la configuration du plugin</strong>.
Quand votre serveur est en ligne, configurez le port que va utiliser le plugin pour communiquer avec le site, pour cela tapez la commande <code class="prettyprint">/mineweb port PORT</code> en remplaçant bien sur <strong>PORT</strong> par un port <strong>disponible</strong>, <strong>non utilisé</strong> et <strong>ouvert</strong>.</p>

<aside class="alert alert-info">
Si vous ne savez pas quel port utiliser, demandez à votre hébergeur minecraft quels ports sont disponibles. Si vous utilisez un Dédié ou un VPS, essayez par exemple des ports comme 4343 ou ou 26178.
</aside>

<p>Une fois que cette commande est effectuée tapez <code class="prettyprint">/mineweb setup</code>. Et rendez-vous sur la page de liaison site-serveur dans le panel admin.</p>

<p>Maintenant que vous avez configuré le serveur vous pouvez <strong>ajouter un serveur</strong> et remplir les informations nécessaires :</p>

<ul>
<li>Type de la connexion, donc mettez <em>Par défaut</em>.</li>
<li>Nom par le nom affiché.</li>
<li>IP par l’ip (ou domaine) sans le port.</li>
<li>Port configuré par le port que vous avez tapé juste avant.</li>
</ul>

<p>Cliquez ensuite sur Connexion pour tester la connexion, si celle-ci échoue, votre <strong>port n’est pas ouvert</strong> ou <strong>non disponible</strong>.</p>

<h2 id="liaison-un-serveur-bungeecord">Liaison à un serveur BungeeCord</h2>

<p>Même processus que pour la liaison Bukkit/Spigot mais avec le <a href="http://mineweb.org/plugin_bungee/1.0.3-mineweb_bungee.jar">plugin BungeeCord</a> et vous devez mettre comme type de connexion <em>Bungeecord</em>.</p>

<h2 id="liaison-par-ping">Liaison par Ping</h2>

<p>Vous n’avez pas besoin de plugin pour cette liaison, il vous suffit juste de configurer un serveur comme ceci depuis la page de liaison :</p>

<ul>
<li>Type de la connexion, donc mettez <em>Ping</em>.</li>
<li>Nom par le nom affiché.</li>
<li>IP par l’ip (ou domaine) <strong>sans le port</strong>.</li>
<li>Port de votre serveur (25565 par défaut si vous n’avez pas de port).</li>
</ul>

<p>Cliquez ensuite sur <em>Connexion</em> pour tester la connexion.</p>

<h2 id="la-connexion-choue">La connexion échoue</h2>

<p>Dans un premier temps, vérifiez que vous n&#39;avez pas d&rsquo;<strong>erreur dans la console</strong> de votre serveur en rapport avec le plugin MineWeb.</p>

<p>Dans un second temps, vérifiez que le <strong>port</strong> que vous avez configuré est <strong>ouvert</strong> et <strong>non utilisé</strong> (demandez à votre hébergeur minecraft si vous ne savez pas lequel utiliser).</p>

<p>Ensuite, essayez de <strong>redémarrer votre serveur</strong> juste après avoir fait les commandes, puis testez la connexion à nouveau.</p>

<p>Si la connexion échoue toujours, contactez le <a href="http://mineweb.org/support">support</a> avec un maximum d&#39;explications et d&#39;informations, et répondez à ces questions :</p>

<ul>
<li>Quelle IP avez-vous mis ?</li>
<li>Quel port ?</li>
<li>Comment êtes-vous sûr que le port est ouvert ?</li>
<li>Avez-vous fait toutes les commandes indiquées dans la doc ?</li>
<li>Aucune erreur dans la console ?</li>
<li>Avez-vous essayé de rédemarrer le serveur après avoir fait les commandes ?</li>
</ul>

          <h1 id="cr-er-un-plugin">Créer un plugin</h1>

<h3 id="introduction">Introduction</h3>

<p>Un plugin (aussi appelé <em>extension</em>), c’est des <strong>fichiers</strong> qui sont ajoutés à votre CMS pour y ajouter plusieurs <strong>fonctionnalités</strong> ou modifier certains <strong>comportement</strong> par défaut. Différents plugins “officiels” sont <em>déjà disponibles</em> sur le site de MineWeb. D’autres peuvent être <em>développés par la communauté</em> et c’est le but de ce tutoriel.</p>

<h2 id="cr-ation">Création</h2>

<h3 id="cr-ation-des-fichiers-dossiers">Création des fichiers/dossiers</h3>

<p>Dans un premier temps, il va falloir créer le dossier de votre plugin, ce dossier doit être créé dans le dossier <code class="prettyprint">app/Plugin/</code>. Le nom du dossier doit être le nom de votre plugin.</p>

<p>Par <strong>exemple</strong> si je veux créer un plugin de <strong>boutique</strong>, je vais l’appeler : <strong>Shop</strong>.</p>

<p>Une fois ce dossier créé, il faut créer différents autres dossiers et fichiers :</p>

<ul>
<li>Config/</li>
<li>Controller/</li>
<li>Controller/Component/</li>
<li>Model/</li>
<li>Model/Behavior</li>
<li>View/</li>
<li>View/Helper/</li>
<li>View/Layouts</li>
<li>lang/</li>
<li>SQL/</li>
</ul>

<p>C’est tout pour les dossiers, il nous reste maintenant encore des fichiers à créer tels que :</p>

<ul>
<li>Config/bootstrap.php</li>
<li>Config/routes.php</li>
<li>config.json</li>
</ul>

<h3 id="explications-et-configuration">Explications et configuration</h3>

<p>Maintenant que vous avez créé tout ces fichiers, nous allons passer à la configuration de votre plugin. Pour cela, ouvrez le fichier <strong>config.json</strong>, c&#39;est dans ce fichier que toute la configuration sera située.</p>

<blockquote>
<p>Configuration par défaut (à remplir)</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"NAME"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slug"</span><span class="p">:</span><span class="s2">"SLUG"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nav"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_group_menu"</span><span class="p">:</span><span class="s2">"customisation"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_name"</span><span class="p">:</span><span class="s2">"Boutique"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_icon"</span><span class="p">:</span><span class="s2">"shopping-cart"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_route"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"author"</span><span class="p">:</span><span class="s2">"AUTHOR"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="s2">"0.1.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"apiID"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"useEvents"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"available"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"0"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"requirements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"CMS"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&gt;= 1.1.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Maintenant, vous allez pouvoir configurer. Remplacez <strong>NAME</strong> par le <em>nom de votre plugin</em>, <strong>SLUG</strong> par le <em>nom du dossier</em> et puis AUTHOR par votre pseudo.
Ensuite voici une explication des autres lignes :</p>

<ul>
<li>nav : Si votre plugin est affiché ou non dans la barre de navigation (<strong>Boolean</strong>),</li>
<li>admin : Si votre plugin a besoin de fichiers pour l’administrer (<strong>Boolean</strong>),</li>
<li>admin_group_menu : Si votre plugin a besoin de fichiers pour l’administrer, le nom de la section de liens dans le panel admin (<strong>String</strong>)<em>(Optionnel)</em>,</li>
</ul>

<table><thead>
<tr>
<th>Valeur</th>
<th>Explication</th>
</tr>
</thead><tbody>
<tr>
<td><code class="prettyprint">general</code></td>
<td>Correspondant au menu &lsquo;Général&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">customisation</code></td>
<td>Correspondant au menu &#39;Personnalisation&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">server</code></td>
<td>Correspondant au menu &#39;Serveur&rsquo; du panel admin</td>
</tr>
<tr>
<td><code class="prettyprint">other</code> / <code class="prettyprint">default</code></td>
<td>Correspondant au menu &#39;Autres&rsquo; du panel admin</td>
</tr>
</tbody></table>

<ul>
<li>admin_name : Si votre plugin a besoin de fichiers pour l’administrer, le nom du lien dans le panel admin (<strong>String</strong>),</li>
<li>admin_icon : Si votre plugin a besoin de fichiers pour l’administrer, le nom de l&#39;icone FontAwesome qui doit précéder le nom de l&#39;onglet (<strong>String</strong>)(Optionnel),</li>
<li>admin_route : Si votre plugin a besoin de fichiers pour l’administrer, la route du controller admin (<strong>String</strong>),</li>
<li>version : La version de votre plugin (<strong>Double</strong>),</li>
<li>apiID : L’ID du plugin, ce champ est à remplir par la valeur -1 (<em>Sera automatiquement rempli après</em>),</li>
<li>useEvents : Si votre plugin utilise les événements disponible sur le CMS (<strong>Boolean</strong>),</li>
<li>permissions : Les permissions de votre plugin (voir plus tard) (<strong>Array</strong>)</li>
</ul>

<h3 id="les-sous-menu-du-panel-admin">Les sous-menu du panel admin</h3>

<p>Vous pouvez, si vous le souhaitez, avoir un menu au niveau du panel admin avec des sous-liens (comme pour la boutique). Pour ceci, il vous suffit d&#39;ajouter la clé <code class="prettyprint">admin_menus</code> dans la configuration du plugin juste après <code class="prettyprint">admin_icon</code> (Et donc la clé <code class="prettyprint">admin_route</code> devient optionnelle).</p>

<blockquote>
<p>Associez-lui comme valeur un tableau avec vos sous-lien, comme ceci par exemple :</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"NAME"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slug"</span><span class="p">:</span><span class="s2">"SLUG"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"nav"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_group_menu"</span><span class="p">:</span><span class="s2">"customisation"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_name"</span><span class="p">:</span><span class="s2">"Boutique"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_icon"</span><span class="p">:</span><span class="s2">"shopping-cart"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"admin_menus"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Gérer les articles"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"shopping-basket"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_ITEMS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Gérer les promotions"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"percent"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop/shop/vouchers"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_VOUCHERS"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Gérer les paiements"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit-card"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/admin/shop/payment"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"permission"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SHOP__ADMIN_MANAGE_PAYMENT"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"author"</span><span class="p">:</span><span class="s2">"AUTHOR"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="s2">"0.1.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"apiID"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"useEvents"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"permissions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"available"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"default"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"0"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"2"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"requirements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"CMS"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&gt;= 1.1.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>La clé <code class="prettyprint">permission</code> dans chaque lien est optionnelle, elle permet d&#39;afficher le lien seulement si la permission est accordée au groupe de l&#39;utilisateur.</p>
</blockquote>

<h2 id="les-tables-sql">Les tables SQL</h2>

<p>Les tables dont vous avez besoin pour votre plugin vont être générées automatiquement par un Shell.
Dans un premier temps, toutes les tables de votre plugin doivent être préfixé par le nom de votre plugin.
Par exemple, pour le plugin Shop les tables doivent être préfixés par <strong>shop__</strong>.</p>

<p>Pour générer vos tables automatiquement dans un schema (qui sera <strong>indispensable</strong> pour avoir un plugin valide) il vous faut vous rendre sur le ssh de votre VPS/Ordinateur/Dédié pour pouvoir utiliser la console de CakePHP. Il vous faut ensuite vous rendre dans le dossier contenant les fichiers du CMS puis, il vous faudra taper
<code class="prettyprint">app/Console/cake schema generate plugin-shop</code>
Un fichier <em>schema.php</em> sera automatiquement créé dans le dossier SQL de votre plugin.</p>

<p>Si vous ne pouvez pas accéder à la console de CakePHP, vous pouvez toujours créer votre fichier <em>SQL/schema.php</em> <strong>manuellement</strong>.</p>

<blockquote>
<p>Vous devez commençer le fichier comme ceci</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">ShopAppSchema</span> <span class="k">extends</span> <span class="nx">CakeSchema</span> <span class="p">{</span>

    <span class="k">public</span> <span class="nv">$file</span> <span class="o">=</span> <span class="s1">'schema.php'</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">before</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">after</span><span class="p">(</span><span class="nv">$event</span> <span class="o">=</span> <span class="k">array</span><span class="p">())</span> <span class="p">{}</span>
<span class="p">}</span>
</code></pre>

<blockquote>
<p>Il vous faut ensuite suivre la documentation <a href="http://book.cakephp.org/2.0/fr/console-and-shells/schema-management-and-migrations.html#ecrire-un-schema-cakephp-a-la-main">ici</a></p>
</blockquote>

<h2 id="callbacks">Callbacks</h2>

<p>Les <strong>callbacks</strong> sont des fonctions appelées automatiquement par le CMS lors de certaines actions.</p>

<p>Vous pouvez, si vous le souhaitez, créer un fichier <strong>MainComponent.php</strong> dans le dossier <code class="prettyprint">Controller/Component</code> de votre plugin.</p>

<blockquote>
<p>Dans ce fichier vous pouvez y ajouter :</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">MainComponent</span> <span class="k">extends</span> <span class="nx">Object</span> <span class="p">{</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">onEnable</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">onDisable</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>

<p>Ces fonctions <strong>onEnable</strong> et <strong>onDisable</strong> seront <strong>automatiquement</strong> appelées par le CMS lors de l’<strong>installation</strong>, l’<strong>activation</strong> <em>(pour le onEnable)</em>, et pour la <strong>désinstallation</strong> et la <strong>désactivation</strong> <em>(pour le onDisable)</em> du plugin.</p>

<h2 id="fonctions-disponibles">Fonctions disponibles</h2>

<p><em>Toutes les fonctions/variables présentes ici, sont celles du <strong>EyPluginComponent</strong>.</em></p>

<h3 id="fonctions">Fonctions</h3>

<p>Tout comme les variables, certaines méthodes/fonctions sont disponibles pour vous permettre d’interagir avec les plugins installés.
Tout d’abord vous avez la fonction <strong>loadPlugins()</strong> qui vous retournera tout comme la variable <strong>$pluginsLoaded</strong> (voir ci-dessous) les plugins chargés et installés, cette méthode/fonction vous donne simplement les données à jour si celle-ci ont été modifiés depuis le chargement du Component des plugins.</p>

<p>Vous avez ensuite la fonction <strong>getPluginConfig($slug)</strong> qui vous retourne le JSON de la configuration d’un plugin. Vous devez <strong>spécifier</strong> le <strong>slug du plugin</strong>, par exemple, pour Boutique c’est Shop.</p>

<p>Vous pouvez savoir si un plugin est installé avec <strong>isInstalled(<em>$id</em>)</strong>, qui retourne un <strong>boolean</strong>, sachant que <em>$id</em> est l’ID au format <em>auteur.nom.apiID</em>.</p>

<p>Vous pouvez rechercher un plugin avec différentes fonctions :</p>

<ul>
<li><strong>findPluginsByName(<em>$name</em>)</strong></li>
<li><strong>findPluginBySlug(<em>$slug</em>)</strong></li>
<li><strong>findPluginByApiID(<em>$apiid</em>)</strong></li>
<li><strong>findPluginByID(<em>$id</em>)</strong></li>
<li><strong>findPluginsByAuthor(<em>$author</em>)</strong></li>
</ul>

<p>Qui vous retournerons ou <strong>un objet</strong> contenant les données du/des plugin(s) trouvé(s) (selon la fonction) avec comme clé l’ID du plugin. Ou la fonction vous retournera <strong>objet vide</strong> si aucun plugin ne correspond à la recherche.</p>

<h3 id="variables">Variables</h3>

<p>Les plugins sont chargés dès le chargement de votre site, en effet le CMS <strong>installe automatiquement</strong> les plugins qui sont valides dans le dossier <em>/app/Plugin/</em> et qui ne sont pas encore présent dans la base de données. Et celui-ci <strong>supprime</strong> aussi <strong>automatiquement</strong> les plugins qui sont encore en base de données mais plus dans le dossier.</p>

<p>Après ces opérations effectuées, le CMS <strong>rafraichi les permissions</strong> (pour pouvoir supprimer/ajouter les permissions des plugins installés/supprimés).
Une fois cela fais, vous pouvez accèder à une variable automatiquement initialisée nommée <strong>$pluginsLoaded</strong>. Celle-ci contient les différents plugins chargés et installés en base de données.</p>

<blockquote>
<p>Vous pouvez l’utilisez comme ceci :</p>
</blockquote>
<pre class="highlight php"><code><span class="cp">&lt;?php</span>
<span class="nx">debug</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">EyPlugin</span><span class="o">-&gt;</span><span class="na">pluginsLoaded</span><span class="p">);</span> <span class="c1">// Dans un controller
</span></code></pre>

<blockquote>
<p>Ce qui retournera :</p>
</blockquote>
<pre class="highlight php"><code>object(stdClass) {
  eywek.support.2 =&gt; object(stdClass) {
      name =&gt; 'Support'
      slug =&gt; 'support'
      nav =&gt; true
      admin =&gt; false
      author =&gt; 'Eywek'
      version =&gt; '0.2.0'
      apiID =&gt; (int) 2
      useEvents =&gt; false
      permissions =&gt; object(stdClass) {
          available =&gt; array(
              (int) 0 =&gt; 'POST_TICKET',
              (int) 1 =&gt; 'VIEW_TICKETS',
              (int) 2 =&gt; 'VIEW_ALL_TICKETS',
              (int) 3 =&gt; 'DELETE_ALL_TICKETS',
              (int) 4 =&gt; 'DELETE_HIS_TICKET',
              (int) 5 =&gt; 'RESOLVE_HIS_TICKET',
              (int) 6 =&gt; 'RESOLVE_ALL_TICKETS',
              (int) 7 =&gt; 'SHOW_TICKETS_ANWSERS',
              (int) 8 =&gt; 'REPLY_TO_HIS_TICKETS',
              (int) 9 =&gt; 'REPLY_TO_ALL_TICKETS'
          )
          default =&gt; object(stdClass) {
              0 =&gt; array(
                  (int) 0 =&gt; 'POST_TICKET',
                  (int) 1 =&gt; 'VIEW_TICKETS',
                  (int) 2 =&gt; 'DELETE_HIS_TICKET',
                  (int) 3 =&gt; 'RESOLVE_HIS_TICKET',
                  (int) 4 =&gt; 'SHOW_TICKETS_ANWSERS',
                  (int) 5 =&gt; 'REPLY_TO_HIS_TICKETS'
              )
              2 =&gt; array(
                  (int) 0 =&gt; 'POST_TICKET',
                  (int) 1 =&gt; 'VIEW_TICKETS',
                  (int) 2 =&gt; 'DELETE_HIS_TICKET',
                  (int) 3 =&gt; 'RESOLVE_HIS_TICKET',
                  (int) 4 =&gt; 'SHOW_TICKETS_ANWSERS',
                  (int) 5 =&gt; 'REPLY_TO_HIS_TICKETS'
              )
          }
      }
      tables =&gt; array(
          (int) 0 =&gt; 'support__tickets',
          (int) 1 =&gt; 'support__reply_tickets'
      )
  }
  eywek.shop.1 =&gt; object(stdClass) {
      name =&gt; 'Boutique'
      slug =&gt; 'shop'
      nav =&gt; true
      admin =&gt; false
      author =&gt; 'Eywek'
      version =&gt; '0.3.1'
      apiID =&gt; (int) 1
      useEvents =&gt; false
      permissions =&gt; object(stdClass) {
          available =&gt; array(
              (int) 0 =&gt; 'CREDIT_ACCOUNT',
              (int) 1 =&gt; 'CAN_BUY'
          )
          default =&gt; object(stdClass) {
              0 =&gt; array(
                  (int) 0 =&gt; 'CREDIT_ACCOUNT',
                  (int) 1 =&gt; 'CAN_BUY'
              )
              2 =&gt; array(
                  (int) 0 =&gt; 'CREDIT_ACCOUNT',
                  (int) 1 =&gt; 'CAN_BUY'
              )
          }
      }
      tables =&gt; array(
          (int) 0 =&gt; 'shop__items',
          (int) 1 =&gt; 'shop__categories',
          (int) 2 =&gt; 'shop__vouchers',
          (int) 3 =&gt; 'shop__paypals',
          (int) 4 =&gt; 'shop__paysafecards',
          (int) 5 =&gt; 'shop__paysafecard_messages',
          (int) 6 =&gt; 'shop__starpasses'
      )
  }
}
</code></pre>

<p>Les plugins sont différencier avec un <strong>ID</strong> propre à eux-même qui se compose comme ceci : <em>auteur.slug.apiID</em>
Où le slug est le nom du dossier de votre plugin.</p>

<p>Vous avez aussi accès aux variables <strong>$pluginsInFolder</strong> et <strong>$pluginsInDB</strong> qui vous retourne un array des plugins contenus dans leur dossier ou en base de données (donc installés).
Ces listes <strong>ne sont pas rafraîchi</strong> après la suppression et/ou installation de nouveaux plugins. Il y a donc de forte chance que celles-ci ne soient pas à jour.</p>

<h2 id="utiliser-les-events">Utiliser les events</h2>

<h2 id="utiliser-les-modules">Utiliser les modules</h2>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
